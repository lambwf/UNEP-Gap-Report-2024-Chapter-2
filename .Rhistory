regions = read.xlsx("../Codebase/IPCC_ar6_wgiii_region_classification.xlsx",sheet=3)
regions$region_ar6_6 <- gsub("Eastern Europe and West-Central Asia","E. Europe & W. Asia",regions$region_ar6_6)
data_percap <- data_percap %>%
left_join(.,regions %>% select(iso=ISO,region_ar6_6)) %>%
mutate(region_ar6_6=ifelse(iso=="EU27","Developed Countries",region_ar6_6))
## Plot
region_list <- unique(regions$region_ar6_6)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region_ar6_6!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region_ar6_6==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region_ar6_6 == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none",plot.subtitle = element_text(colour=region_colours[i],face = "bold")) +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
combined_plot <- wrap_plots(p)
# Remove x-axis for plots 1, 2, and 3
combined_plot[[1]] <- combined_plot[[1]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),axis.title.y = element_text(hjust = 1.05)) +
labs(title="Per capita emissions vs change in total emissions")
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
# Remove y-axis for plots 2, 3, 5, and 6
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[5]] <- combined_plot[[5]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[6]] <- combined_plot[[6]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(),axis.title.x = element_blank())
combined_plot[[4]] <- combined_plot[[4]] + theme(axis.title.x = element_blank(),axis.title.y = element_blank()) + labs(caption="\n⌂ Data: EDGAR v9  \n⌂ Note: GWP100 AR6; land use change (LULUCF) emissions and removals excluded; 3 countries above 30tCO2e/capita excluded\n (Qatar, Bahrain, Kuwait); top 6 emitters by total GHG emissions labelled")
combined_plot
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.png",path = "results/standard/",device = "png",height = 6,width=9,dpi=300)
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.pdf",path = "results/standard/",device = cairo_pdf,height = 6,width=9)
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.svg",path = "results/standard/",device = 'svg',height = 6,width=9)
## Aggregate emissions data
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(value=sum(value,na.rm=T))
## Join population and calculate per capita emissions, filter out NAs
data_percap <- data_percap %>%
left_join(.,data_wdi_pop %>% select(iso,year,population),by=join_by("iso","year")) %>%
mutate(ghg_pc=value/population) %>%
filter(!is.na(population))
## Add World
# data_percap_world <- data_percap %>%
#   mutate(iso="WLD",country="World") %>%
#   group_by(iso,country,year) %>%
#   summarise(value=sum(value),population=sum(population)) %>%
#   mutate(ghg_pc=value/population)
#
# data_percap <- rbind(data_percap,data_percap_world)
## Add Europe
# data_percap_eu <- data_percap %>%
#   left_join(.,cc_EU,by="iso") %>%
#   filter(!is.na(EU)) %>%
#   mutate(iso="EU27",country="European Union") %>%
#   group_by(iso,country,year) %>%
#   summarise(value=sum(value),population=sum(population)) %>%
#   mutate(ghg_pc=value/population)
#
# data_percap <- rbind(data_percap,data_percap_eu)
data_percap <- data_percap %>%
left_join(.,cc_EU,by="iso") %>%
mutate(iso=ifelse(!is.na(EU),"EU27",iso)) %>%
mutate(country=ifelse(!is.na(EU),"European Union",country)) %>%
group_by(iso,country,year) %>%
summarise(value=sum(value),population=sum(population)) %>%
mutate(ghg_pc=value/population)
## Calculate the rate of change in the past 3 years, slice to last year
data_percap <- data_percap %>%
filter(year >= max(data_percap$year)-2) %>%
group_by(iso) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=change*100) %>%
filter(year==max(data_percap$year))
## Load regions
regions = read.xlsx("../Codebase/IPCC_ar6_wgiii_region_classification.xlsx",sheet=3)
regions$region_ar6_6 <- gsub("Eastern Europe and West-Central Asia","E. Europe & W. Asia",regions$region_ar6_6)
data_percap <- data_percap %>%
left_join(.,regions %>% select(iso=ISO,region_ar6_6)) %>%
mutate(region_ar6_6=ifelse(iso=="EU27","Developed Countries",region_ar6_6))
## Plot
region_list <- unique(regions$region_ar6_6)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region_ar6_6!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region_ar6_6==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region_ar6_6 == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
combined_plot <- wrap_plots(p)
# Remove x-axis for plots 1, 2, and 3
combined_plot[[1]] <- combined_plot[[1]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),axis.title.y = element_text(hjust = 1.05)) +
labs(title="Per capita emissions vs change in total emissions")
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
# Remove y-axis for plots 2, 3, 5, and 6
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[5]] <- combined_plot[[5]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[6]] <- combined_plot[[6]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(),axis.title.x = element_blank())
combined_plot[[4]] <- combined_plot[[4]] + theme(axis.title.x = element_blank(),axis.title.y = element_blank()) + labs(caption="\n⌂ Data: EDGAR v9  \n⌂ Note: GWP100 AR6; land use change (LULUCF) emissions and removals excluded; 3 countries above 30tCO2e/capita excluded\n (Qatar, Bahrain, Kuwait); top 6 emitters by total GHG emissions labelled")
combined_plot
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.png",path = "results/standard/",device = "png",height = 6,width=9,dpi=300)
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.pdf",path = "results/standard/",device = cairo_pdf,height = 6,width=9)
ggsave(combined_plot,filename = "UNEP-EGR-2024-percapita-change.svg",path = "results/standard/",device = 'svg',height = 6,width=9)
View(data_percap)
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(value,na.rm=T))
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(value,na.rm=T))
data_percap <- data_percap %>%
left_join(.,data_wdi_pop %>% select(iso,year,population),by=join_by("iso","year")) %>%
filter(!is.na(population))
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(value,na.rm=T))
## Join population, filter out NAs
data_percap <- data_percap %>%
left_join(.,data_wdi_pop %>% select(iso,year,population),by=join_by("iso","year")) %>%
filter(!is.na(population))
## Add Europe, calculate per capita emissions
data_percap <- data_percap %>%
left_join(.,cc_EU,by="iso") %>%
mutate(iso=ifelse(!is.na(EU),"EU27",iso)) %>%
mutate(country=ifelse(!is.na(EU),"European Union",country)) %>%
group_by(iso,country,year) %>%
summarise(value=sum(value),population=sum(population)) %>%
mutate(ghg_pc=value/population)
data_percap <- data_percap %>%
left_join(.,cc_EU,by="iso") %>%
mutate(iso=ifelse(!is.na(EU),"EU27",iso)) %>%
mutate(country=ifelse(!is.na(EU),"European Union",country)) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(ghg),population=sum(population)) %>%
mutate(ghg_pc=ghg/population)
data_percap <- data_percap %>%
filter(year >= max(data_percap$year)-2) %>%
group_by(iso) %>%
mutate(change=growth_rate(year,ghg)$rate) %>%
mutate(change=change*100) %>%
filter(year==max(data_percap$year))
regions = read.xlsx("../Codebase/IPCC_ar6_wgiii_region_classification.xlsx",sheet=3)
regions$region_ar6_6 <- gsub("Eastern Europe and West-Central Asia","E. Europe & W. Asia",regions$region_ar6_6)
data_percap <- data_percap %>%
left_join(.,regions %>% select(iso=ISO,region_ar6_6)) %>%
mutate(region_ar6_6=ifelse(iso=="EU27","Developed Countries",region_ar6_6))
region_list <- unique(regions$region_ar6_6)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
data_percap <- data_percap %>%
select(iso,country,region=region_ar6_6,year,everything())
## Aggregate emissions data
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(value,na.rm=T))
## Join population, filter out NAs
data_percap <- data_percap %>%
left_join(.,data_wdi_pop %>% select(iso,year,population),by=join_by("iso","year")) %>%
filter(!is.na(population))
## Add Europe, calculate per capita emissions
data_percap <- data_percap %>%
left_join(.,cc_EU,by="iso") %>%
mutate(iso=ifelse(!is.na(EU),"EU27",iso)) %>%
mutate(country=ifelse(!is.na(EU),"European Union",country)) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(ghg),population=sum(population)) %>%
mutate(ghg_pc=ghg/population)
## Calculate the rate of change in ghg emissions the past 3 years, slice to last year
data_percap <- data_percap %>%
filter(year >= max(data_percap$year)-2) %>%
group_by(iso) %>%
mutate(change_3yr=growth_rate(year,ghg)$rate) %>%
mutate(change_3yr=change_3yr*100) %>%
filter(year==max(data_percap$year))
## Join IPCC regions
regions = read.xlsx("../Codebase/IPCC_ar6_wgiii_region_classification.xlsx",sheet=3)
regions$region_ar6_6 <- gsub("Eastern Europe and West-Central Asia","E. Europe & W. Asia",regions$region_ar6_6)
data_percap <- data_percap %>%
left_join(.,regions %>% select(iso=ISO,region_ar6_6)) %>%
mutate(region_ar6_6=ifelse(iso=="EU27","Developed Countries",region_ar6_6))
## Tidy
data_percap <- data_percap %>%
select(iso,country,region=region_ar6_6,year,everything())
region_list <- unique(regions$region_ar6_6)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change_3yr,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region_ar6_6!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region_ar6_6==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region_ar6_6 == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change_3yr,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
data_percap <- data_edgar %>%
filter(year>=1990) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(value,na.rm=T))
## Join population, filter out NAs
data_percap <- data_percap %>%
left_join(.,data_wdi_pop %>% select(iso,year,population),by=join_by("iso","year")) %>%
filter(!is.na(population))
## Add Europe, calculate per capita emissions
data_percap <- data_percap %>%
left_join(.,cc_EU,by="iso") %>%
mutate(iso=ifelse(!is.na(EU),"EU27",iso)) %>%
mutate(country=ifelse(!is.na(EU),"European Union",country)) %>%
group_by(iso,country,year) %>%
summarise(ghg=sum(ghg),population=sum(population)) %>%
mutate(ghg_pc=ghg/population)
## Calculate the rate of change in ghg emissions the past 3 years, slice to last year
data_percap <- data_percap %>%
filter(year >= max(data_percap$year)-2) %>%
group_by(iso) %>%
mutate(change_3yr=growth_rate(year,ghg)$rate) %>%
mutate(change_3yr=change_3yr*100) %>%
filter(year==max(data_percap$year))
## Join IPCC regions
regions = read.xlsx("../Codebase/IPCC_ar6_wgiii_region_classification.xlsx",sheet=3)
regions$region_ar6_6 <- gsub("Eastern Europe and West-Central Asia","E. Europe & W. Asia",regions$region_ar6_6)
data_percap <- data_percap %>%
left_join(.,regions %>% select(iso=ISO,region_ar6_6)) %>%
mutate(region_ar6_6=ifelse(iso=="EU27","Developed Countries",region_ar6_6))
## Tidy
data_percap <- data_percap %>%
select(iso,country,region=region_ar6_6,year,everything())
## Prepare plot factors, colours, etc.
region_list <- unique(regions$region)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
## Plot
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change_3yr,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
region_list <- unique(regions$region_ar6_6)
region_colours <- c("#d45087ff","#659cccff","#e5b82cff","#ff9055ff","#7dd396ff","#17becfff")
p <- vector("list", length(region_list))
country_highlight <- data_percap %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20="1")) %>%
filter(G20==1) %>%
filter(iso %in% c("CHN","USA","IND","EU27","RUS","BRA"))
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change_3yr,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region == region_list[i]),
aes(x = ghg_pc, y = change, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
combined_plot <- wrap_plots(p)
# Remove x-axis for plots 1, 2, and 3
combined_plot[[1]] <- combined_plot[[1]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),axis.title.y = element_text(hjust = 1.05)) +
labs(title="Per capita emissions vs change in total emissions")
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
# Remove y-axis for plots 2, 3, 5, and 6
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[5]] <- combined_plot[[5]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[6]] <- combined_plot[[6]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(),axis.title.x = element_blank())
combined_plot[[4]] <- combined_plot[[4]] + theme(axis.title.x = element_blank(),axis.title.y = element_blank()) + labs(caption="\n⌂ Data: EDGAR v9, World Bank \n⌂ Note: GWP100 AR6; land use change (LULUCF) emissions and removals excluded; 3 countries above 30tCO2e/capita excluded\n (Qatar, Bahrain, Kuwait); top 6 emitters by total GHG emissions labelled")
combined_plot
for (i in 1:length(region_list)) {
fill_colour <- adjustcolor(region_colours[i], alpha.f = 0.6)
p[[i]] <- ggplot(data_percap,aes(x=ghg_pc,y=change_3yr,label=country)) +
geom_hline(yintercept=0,colour="#636363")+
geom_point(data=data_percap %>% filter(region!=region_list[i]),shape=21,size=2,colour="#bdbdbd",fill="#bdbdbd") +
geom_point(data=data_percap %>% filter(region==region_list[i]),shape=21,size=2.75,colour="#636363",fill=region_colours[i]) +
geom_label_repel(
data = country_highlight %>% filter(region == region_list[i]),
aes(x = ghg_pc, y = change_3yr, label = country),
size = 3.5,
fill = "white",
alpha=0.8,
label.size=NA,
min.segment.length = 0,       # Always draw a segment
segment.color = "#636363",     # Color of the line
segment.size = 0.6,           # Thickness of the line
box.padding = 1.25,            # Extra space around the label
point.padding = 0.25,          # Extra space around the point
max.overlaps = 125,force = 6,force_pull = 1,nudge_y = 1,nudge_x=3# Allow a bit more overlaps if needed
) +
theme_wl() +
xlim(0,30) +
ylim(-12,12) +
theme(legend.position="none") +
labs(subtitle=region_list[i],
x="Per capita greenhouse gas emissions (tCO2e/person)",
y="Change in total greenhouse gas emissions from 2021-2023 (%)")
}
combined_plot <- wrap_plots(p)
# Remove x-axis for plots 1, 2, and 3
combined_plot[[1]] <- combined_plot[[1]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),axis.title.y = element_text(hjust = 1.05)) +
labs(title="Per capita emissions vs change in total emissions")
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
# Remove y-axis for plots 2, 3, 5, and 6
combined_plot[[2]] <- combined_plot[[2]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[3]] <- combined_plot[[3]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[5]] <- combined_plot[[5]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
combined_plot[[6]] <- combined_plot[[6]] + theme(axis.title.y = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(),axis.title.x = element_blank())
combined_plot[[4]] <- combined_plot[[4]] + theme(axis.title.x = element_blank(),axis.title.y = element_blank()) + labs(caption="\n⌂ Data: EDGAR v9, World Bank \n⌂ Note: GWP100 AR6; land use change (LULUCF) emissions and removals excluded; 3 countries above 30tCO2e/capita excluded\n (Qatar, Bahrain, Kuwait); top 6 emitters by total GHG emissions labelled")
combined_plot
blarg <- data_percap %>%
gather(.,var,value,ghg:change_3yr)
View(blarg)
blarg <- data_percap %>%
gather(.,var,value,ghg:change_3yr) %>%
left_join(.,data.frame(var=c("ghg","population","ghg_pc","change_3yr"),units=c("tCO2e (GWP100 AR6)","persons","tCO2e/capita","%")))
blarg <- data_percap %>%
gather(.,var,value,ghg:change_3yr) %>%
left_join(.,data.frame(var=c("ghg","population","ghg_pc","change_3yr"),units=c("tCO2e (GWP100 AR6)","persons","tCO2e/capita","%")),by=join_by(var))
blarg <- data_percap %>%
gather(.,var,value,ghg:change_3yr) %>%
left_join(.,data.frame(var=c("ghg","population","ghg_pc","change_3yr"),units=c("tCO2e (GWP100 AR6)","persons","tCO2e/capita","%")),by=join_by(var)) %>%
arrange(iso,country,region,var)
wb <- createWorkbook()
addWorksheet(wb,"info")
addWorksheet(wb,"data")
info = data.frame(a=c("Author","Contact","Data sources","See also"),
b=c("William F. Lamb",
"william.lamb@pik-potsdam.de",
"EDGARv9 (https://edgar.jrc.ec.europa.eu/report_2024); World Bank (https://databank.worldbank.org/source/population-estimates-and-projections)",
"https://lambwf.github.io/UNEP-Gap-Report-2024-Chapter-2/"))
writeData(wb, sheet = "info",info,colNames = F, rowNames = F)
writeData(wb, sheet = "data",data_percap %>%
gather(.,var,value,ghg:change_3yr) %>%
left_join(.,data.frame(var=c("ghg","population","ghg_pc","change_3yr"),units=c("tCO2e (GWP100 AR6)","persons","tCO2e/capita","%")),by=join_by(var)) %>%
arrange(iso,country,region,var),
colNames = T, rowNames = F)
saveWorkbook(wb,paste0("results/standard/UNEP-EGR-2024-percapita-change.xlsx"),overwrite=T)
