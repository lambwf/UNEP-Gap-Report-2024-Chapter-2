country_change <- country_change %>%
arrange(include_country,sector_lv2_order)
# plot everything
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank()) +
labs(title="Changes in total GHG emissions by country and sector, 2022-2023",
subtitle="MtCO2e/year")
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=0)) +
labs(title="Changes in total GHG emissions by country and sector, 2022-2023",
subtitle="MtCO2e/year")
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1)) +
labs(title="Changes in total GHG emissions by country and sector, 2022-2023",
subtitle="MtCO2e/year")
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=0,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=0,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 8)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
ggplot(country_change, aes(fill = sector_lv2)) +
geom_rect(aes(x = country,
xmin = include_country - 0.25, # control bar gap width
xmax = include_country + 0.25,
ymin = end,
ymax = start),
color="#636363"
) +
geom_segment(aes(x=ifelse(include_country == last(include_country),last(include_country),include_country+0.25),
xend=ifelse(include_country == last(include_country),last(include_country),include_country+0.75),
y=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2),
yend=ifelse(sector_lv2 == "Waste & Other",
end,
# these will be removed once we set the y limits
max(end)*2)),
colour="black") +
geom_text(data=country_change %>% filter(sector_lv2 %in% c("Waste & Other","Total")),
aes(x=country,y=ifelse(grepl("\\+",group_change),end+100,end+100-as.numeric(group_change)),label=group_change),
color="#636363",
size=4) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) +
coord_cartesian(ylim=c(56000,58000)) +
scale_fill_manual(values=colours$sector_lv2_colours) +
#ylab(bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)")) +
theme_wl() +
theme(axis.title = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust=1,hjust=1,angle = 45)) +
labs(subtitle=bquote("Greenhouse gas emissions (Mt" ~CO[2]* "eq/yr)"))
