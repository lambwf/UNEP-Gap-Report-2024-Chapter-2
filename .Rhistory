show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100)) +
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#bf812d","#d8b365","#35978f")) +
#scale_color_manual(values=c("#8c510a","#35978f")) +
labs(title="Transport",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"))
p1 / p2 / p3 / p4
wd_data$category <- as.factor(wd_data$category)
wd_power <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Power") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100)
p1 <- wd_power %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Wind & Solar","Nuclear & Hydro")) %>%
filter(year<=2022) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_power %>%
filter(year==2022) %>%
filter(category %in% c("Fossil (coal)","Fossil (gas)","Wind & Solar","Nuclear & Hydro")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
scale_color_manual(values=c("#525252","#bf812d","#35978f","#80cdc1")) +
labs(title="Power sector",
subtitle="Share of annual electricity production (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"),
plot.margin = margin(0, 0, 0, 0))
wd_industry <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Industry") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p2 <- wd_industry %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_industry %>% filter(year==2021) %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
point.size = NA,
hjust        = 0,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#525252","#bf812d","#35978f")) +
labs(title="Industry",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"),
plot.margin = margin(0, 0, 0, 0))
wd_buildings <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Buildings") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p3 <- wd_buildings %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_buildings %>% filter(year==2021) %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#bf812d","#d8b365","#35978f")) +
labs(title="Buildings",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"),
plot.margin = margin(0, 0, 0, 0))
wd_transport <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Transport") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p4 <- wd_transport %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_transport %>% filter(year==2021) %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100)) +
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#bf812d","#d8b365","#35978f")) +
#scale_color_manual(values=c("#8c510a","#35978f")) +
labs(title="Transport",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"),
plot.margin = margin(0, 0, 0, 0))
p1 / p2 / p3 / p4
wd_data$category <- as.factor(wd_data$category)
wd_power <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Power") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100)
p1 <- wd_power %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Wind & Solar","Nuclear & Hydro")) %>%
filter(year<=2022) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_power %>%
filter(year==2022) %>%
filter(category %in% c("Fossil (coal)","Fossil (gas)","Wind & Solar","Nuclear & Hydro")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
scale_color_manual(values=c("#525252","#bf812d","#35978f","#80cdc1")) +
labs(title="Power sector",
subtitle="Share of annual electricity production (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"))
wd_industry <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Industry") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p2 <- wd_industry %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_industry %>% filter(year==2021) %>% filter(category %in% c("Fossil (coal)","Fossil (gas)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
point.size = NA,
hjust        = 0,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#525252","#bf812d","#35978f")) +
labs(title="Industry",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"))
wd_buildings <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Buildings") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p3 <- wd_buildings %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_buildings %>% filter(year==2021) %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100))+
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#bf812d","#d8b365","#35978f")) +
labs(title="Buildings",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"))
wd_transport <- wd_data %>%
filter(category!="Total") %>%
filter(sector=="Transport") %>%
group_by(country,iso,sector,year) %>%
mutate(sector_total=sum(value)) %>%
mutate(ratio=value/sector_total) %>%
mutate(ratio=ratio*100) %>%
filter(year<=2021)
p4 <- wd_transport %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")) %>%
ggplot(.,aes(x=year,y=ratio,color=category,group=category)) +
geom_path(size=1) +
geom_text_repel(data=wd_transport %>% filter(year==2021) %>% filter(category %in% c("Fossil (gas)","Fossil (oil)","Power sector")),
inherit.aes=FALSE,aes(x=2025,y=ratio,label=round(ratio),color=category),
nudge_x      = 0.25,
direction    = "y",
hjust        = 0,
point.size = NA,
size=3,
show.legend = FALSE,
min.segment.length = Inf
) +
theme_wl() +
facet_wrap(.~country,nrow=1) +
scale_x_continuous(limits=c(1990,2030),breaks=c(2000,2021)) +
scale_y_continuous(limits=c(0,100)) +
#scale_colour_manual(breaks=levels(wd_data$category),values = my_colors$colours) +
scale_color_manual(values=c("#bf812d","#d8b365","#35978f")) +
#scale_color_manual(values=c("#8c510a","#35978f")) +
labs(title="Transport",
subtitle="Share of annual final energy consumption (%)") +
theme(axis.title=element_blank(),
legend.title=element_blank(),
legend.margin = margin(0, 0, 0, 0),
legend.spacing.x = unit(0, "mm"),
legend.spacing.y = unit(0, "mm"))
p1 / p2 / p3 / p4
wd_stats <- wd_data %>%
filter(category!="Total") %>%
group_by(country,iso,sector,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2017) %>%
filter(year<=2021)
wd_stats <- wd_stats %>%
group_by(country,sector) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=round(change*100,1)) %>%
mutate(change=ifelse(change>0,paste0("+",change),paste0(change))) %>%
filter(year==2021)
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
arrange(sector) %>%
select(-value,-units,-iso,-year)
wd_stats <- spread(wd_stats,country,change)
write.xlsx(wd_stats,"results/UNEP-Gap-Report-2024-Sector-Demand-Change.xlsx")
## fossil vs non-fossil
wd_stats <- wd_data %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Fossil",category),"Fossil","non-Fossil")) %>%
group_by(country,iso,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2018) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,iso,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
filter(year==2022) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
wd_stats <- spread(wd_stats,country,sector_ratio)
## coal abs level
wd_stats <- wd_data %>%
filter(sector=="Power") %>%
filter(category=="Fossil (coal)") %>%
filter(year>=2017) %>%
filter(year<=2021)
wd_stats <- wd_stats %>%
group_by(country,iso,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
filter(year==2021) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
View(wd_stats)
wd_stats <- wd_data %>%
filter(category!="Total") %>%
group_by(country,iso,sector,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2017) %>%
filter(year<=2021)
wd_stats <- wd_stats %>%
group_by(country,sector) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=round(change*100,1)) %>%
mutate(change=ifelse(change>0,paste0("+",change),paste0(change))) %>%
filter(year==2021)
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
arrange(sector) %>%
select(-value,-units,-iso,-year)
wd_stats <- spread(wd_stats,country,change)
write.xlsx(wd_stats,"results/UNEP-Gap-Report-2024-Sector-Demand-Change.xlsx")
## fossil vs non-fossil
wd_stats <- wd_data %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Fossil",category),"Fossil","non-Fossil")) %>%
group_by(country,iso,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2018) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,iso,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
filter(year==2022) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
wd_stats <- spread(wd_stats,country,sector_ratio)
wd_stats <- wd_data %>%
filter(category!="Total") %>%
group_by(country,iso,sector,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2017) %>%
filter(year<=2021)
wd_stats <- wd_stats %>%
group_by(country,sector) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=round(change*100,1)) %>%
mutate(change=ifelse(change>0,paste0("+",change),paste0(change))) %>%
filter(year==2021)
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
arrange(sector) %>%
select(-value,-units,-iso,-year)
wd_stats <- spread(wd_stats,country,change)
wd_stats <- wd_data %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Fossil",category),"Fossil","non-Fossil")) %>%
group_by(country,iso,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2018) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,iso,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
filter(year==2022) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
wd_stats <- wd_stats %>%
filter(year==2021) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
wd_stats <- wd_data %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Fossil",category),"Fossil","non-Fossil")) %>%
group_by(country,iso,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year>=2018) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,iso,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats$sector <- as.factor(wd_stats$sector)
wd_stats$sector <- fct_relevel(wd_stats$sector,"Power","Industry","Buildings","Transport")
wd_stats <- wd_stats %>%
filter(year==2021) %>%
filter(category_group=="Fossil") %>%
arrange(sector) %>%
select(-value,-units,-iso,-year,-category_group,-sector_total)
wd_stats <- spread(wd_stats,country,sector_ratio)
wd_stats <- wd_ember %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Wind and Solar",category),"Wind and Solar","Other")) %>%
group_by(country,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats <- wd_stats %>%
filter(year==2022) %>%
filter(category_group=="Wind and Solar") %>%
arrange(desc(sector_ratio))
wd_stats <- wd_ember %>%
filter(category!="Total") %>%
mutate(category_group=ifelse(grepl("Wind & Solar",category),"Wind & Solar","Other")) %>%
group_by(country,sector,category_group,units,year) %>%
summarise(value=sum(value)) %>%
filter(year<=2022)
wd_stats <- wd_stats %>%
group_by(country,sector,units,year) %>%
mutate(sector_total=sum(value)) %>%
ungroup() %>%
mutate(sector_ratio=(value/sector_total)*100) %>%
mutate(sector_ratio=signif(sector_ratio,2))
wd_stats <- wd_stats %>%
filter(year==2022) %>%
filter(category_group=="Wind & Solar") %>%
arrange(desc(sector_ratio))
